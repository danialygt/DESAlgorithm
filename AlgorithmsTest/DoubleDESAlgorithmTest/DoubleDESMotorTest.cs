using Alghotithms.DoubleDESAlgorithm;
using System;
using System.Collections.Generic;
using System.Text;
using Xunit;

namespace AlghotithmsTest.DoubleDESAlgorithmTest
{
    public class DoubleDESMotorTest
    {
        DoubleDESMotor dDesMotor = new DoubleDESMotor();

        #region EncryptionTests
        [Theory]
        [InlineData("0000000100100011010001010110011110001001101010111100110111101111",
                    "0001001100110100010101110111100110011011101111001101111111110001",
                    "1010011001010101010101101011100110011011101111001101110110110101",
                    "0010110011101101011100101111111010001101111110111001011110111101"
        )]
        [InlineData("1001011010011000011001010111010001110101011100100111100110011111",
                    "0001001100110100010101110111100110011011101111001101111111110001",
                    "1010011001010101010101101011100110011011101111001101110110110101",
                    "1100010000111000100011000111110010000110000000101100101011010100"
        )]


        [InlineData("0100000101101100011011110110111100100000010100110110110001101101",
                    "0001001100110100010101110111100110011011101111001101111111110001",
                    "1010011001010101010101101011100110011011101111001101110110110101",
                    "1110011001111000100110010111011101011111100101011110011001110000"
        )]

        public void EncryptTest(string plainText, string key1, string key2, string cipherText)
        {
            Assert.Equal(cipherText, dDesMotor.Encrypt(plainText, key1, key2));
        }
        #endregion
        #region DecryptionTests
        [Theory]
        [InlineData("0000000100100011010001010110011110001001101010111100110111101111",
                    "0001001100110100010101110111100110011011101111001101111111110001",
                    "1010011001010101010101101011100110011011101111001101110110110101",
                    "0010110011101101011100101111111010001101111110111001011110111101"
        )]
        [InlineData("1001011010011000011001010111010001110101011100100111100110011111",
                    "0001001100110100010101110111100110011011101111001101111111110001",
                    "1010011001010101010101101011100110011011101111001101110110110101",
                    "1100010000111000100011000111110010000110000000101100101011010100"
        )]


        [InlineData("0100000101101100011011110110111100100000010100110110110001101101",
                    "0001001100110100010101110111100110011011101111001101111111110001",
                    "1010011001010101010101101011100110011011101111001101110110110101",
                    "1110011001111000100110010111011101011111100101011110011001110000"
        )]

        public void DecryptTest(string plainText, string key1, string key2, string cipherText)
        {
            Assert.Equal(plainText, dDesMotor.Decrypt(cipherText, key1, key2));
        }


        #endregion
    }
}
